<!DOCTYPE html>
<html>
<head>
	<title></title>
	<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<center>
		<div id="app">
			<!-- หน้าป๊อปอัพบังคับกรอกข้อมูล -->
			<div v-if="status_popup" class="popup">
				<div class="popup-content">
					<b>ชื่อ : <input type="text" v-model="name"></b>
					<b>น้ำหนัก : <input type="number" v-model="weight" min="0"> kg.</b>
					<button @click="change_status()">ตกลง</button>
				</div>
			</div>
			<!-- หน้าป๊อปอัพบังคับกรอกข้อมูล -->

			<h1>Planet : {{data.bodies[req_data[point]].englishName}}</h1><!--ชื่อดาว-->

			<h1>Name : {{name}}</h1><!--ชื่อผู้ใช้-->
			<!-- <h1>Gravity : {{data.bodies[req_data[point]].gravity}} m.s <sup>-2</sup> </h1> --><!--แรงโน้มถ่วง-->
			<h1>Weight on Planet : {{calculate_weight(data.bodies[req_data[point]].gravity)}} kg.</h1><br><!--น้ำหนักบนดาวเคราะห์นั้นๆ-->

			<button @click="change_status()">กรอกข้อมูลใหม่</button><br>

			<!-- แถวตาวเคราะห์ -->
			<div v-for="i in 10">
				<div v-if="(i-1) == 1" class="img_planet left_screen" :id="name_id+(i-1)">{{data.bodies[req_data[i-1]].englishName}}</div><!--***ใส่รูปแทนชื่อดาวด้วย***-->
				<div v-else-if="(i-1) == 2" class="img_planet" :id="name_id+(i-1)">{{data.bodies[req_data[i-1]].englishName}}</div><!--***ใส่รูปแทนชื่อดาวด้วย***-->
				<div v-else-if="(i-1) == 3" class="img_planet right_screen" :id="name_id+(i-1)">{{data.bodies[req_data[i-1]].englishName}}</div><!--***ใส่รูปแทนชื่อดาวด้วย***-->
				<div v-else class="invisible" :id="name_id+(i-1)">{{data.bodies[req_data[i-1]].englishName}}</div><!--***ใส่รูปแทนชื่อดาวด้วย***-->
			</div>
			<!-- แถวตาวเคราะห์ -->

			<!-- แถบปุ่มดาวเคราะห์ -->
			<button v-for="i in 10" @click="point = i-1, status = true, direction()" class="planet">{{data.bodies[req_data[i-1]].englishName}}</button><!--***ใส่รูปแทนชื่อดาวด้วย***-->
			<!-- แถบปุ่มดาวเคราะห์ -->

		</div>
	</center>

	<div id='stars'></div><!-- ดาวเล็ก -->
	<div id='stars2'></div><!-- ดาวกลาง-->
	<div id='stars3'></div> <!-- ดาวใหญ่-->

</body>
<script>

	fetch('https://api.le-systeme-solaire.net/rest/bodies/')
			.then(response => response.json())
			.then(json => {
				app.data = json
				console.log(json)
				console.log("โหลด json เสร็จแล้ว")
			})

	let app = new Vue({
			el: '#app',
			data: {
				data:{},//ข้อมูล JSON
				req_data:[240, 244, 243, 0, 239, 238, 241, 199, 219, 208],//ตำแหน่งใน List bodies ["Moon", Mercury", "Venus", "Earth", "Mars", "Jupiter", "Saturn", "Uranus", "Neptune", "Pluto"] ชื่อดาวตามตำแหน่งใน req_data
				weight:0,//น้ำหนักของผู้ใช้
				weight_on_planet:0,//น้ำหนักบนดาวเคราะห์นั้น
				name:"",//ชื่อผู้ใช้
				point:2,//ตำแหน่งในlist req_data
				status_popup:true,//สถานะหน้าpopup
				name_id:"img_planet_",
				L_or_R:"",
				status:false
			},

			methods:{
				calculate_weight:function(gravity){//คำนวณน้ำหนักบนดาวต่างๆ
					this.weight_on_planet = (gravity*this.weight)/9.8
					return this.weight_on_planet.toFixed(2)//toFixed = ทศนิยม...ตำแหน่ง
				},
				change_status:function(){//เปิดปิดป๊อปอัพ
					this.status_popup = !this.status_popup;
				},
				delete_class:function (){//ซ้อนดาวที่ไม่ใช้
					for (var i = 0; i <= 9; i++) {
						if (i < this.point-1 || i > this.point+1) {//ไม่ได้อยู่ในช่วง 3 ดาวที่ต้องแสดงผลใช้ไหม?
							document.getElementById(this.name_id+i).className = "invisible";//ซ้อน
						}
					}
				},
				direction:function () {
					if (this.point > 0 && event.deltaY > 0) {//เช็คว่าซ้ายสุดหรือยัง event.deltaY อ่านค่าจาก scroll mouse โดยที่มากกว่า 0 คือ "ลง"
						this.L_or_R = "left";
						this.point -= 1;
						this.status = true;
					}else if (this.point < 9 && event.deltaY < 0) {//เช็คว่าขวาสุดหรือยัง event.deltaY อ่านค่าจาก scroll mouse โดยที่น้อยกว่า 0 คือ "ขึ้น"
						this.L_or_R = "right";
						this.point += 1;
						this.status = true;
					}
					if (this.status) {//มีการเลื่อนไหม
						this.status = false;
						this.delete_class();
						document.getElementById(this.name_id+this.point).className = "img_planet w3-animate-" + this.L_or_R;
						if (this.point != 0) {//ตัวซ้ายสุดหรือยัง
							document.getElementById(this.name_id+(this.point-1)).className = "img_planet left_screen direction_" + this.L_or_R + "_screen_left";
						}
						if (this.point != 9) {//ตัวขวาสุดหรือยัง
							document.getElementById(this.name_id+(this.point+1)).className = "img_planet right_screen direction_" + this.L_or_R + "_screen_right";
						}
					}
				}
			}
		})

	document.querySelector('html').addEventListener("wheel", app.direction);//เช็คว่าเลื่อน scroll mouse ยัง ถ้าเลื่อนเรียกใช้ methods direction

</script>
</html>